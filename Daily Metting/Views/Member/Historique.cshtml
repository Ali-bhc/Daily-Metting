@model ListSubmissionViewModel
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
<div id="container">
    <div id="submissions-container">

        <table class="table">
            <thead>
            <tr class="table-header">
                <th class="cell">Submission Date</th>
                <th class="cell">details</th>
                
            </tr>
        </thead>
            <partial name="_SubmissionsTable" />
            @*<tbody class="submissions">

        @foreach (var sub in Model.Submissions)
            {
                <tr>
                    <td>@sub.submission_time.ToString("dd/MM/yyyy")</td>
                    <td>details</td>
                   
                </tr>
            } 
            </tbody>*@
        </table>

        <div class="pagination">
                @if (Model.page > 1)
                {
                    <a href="#" class="page-link" data-page=@Model.page-1>Previous</a>
                }

                @for (int i = 1; i <= Model.totalPages; i++)
                {
                    if (i == Model.page)
                    {
                        <span class="page-link current">@i</span>
                    }
                    else
                    {
                        <a href="#" class="page-link" data-page=@i>@i</a>
                    }
                }

                @if (Model.page <= Model.totalPages)
                {
                <a href="#" class="page-link" data-page=@((Model.page+1);)>Next</a>
            }
        </div>


        
@*        <div id="pagination-container">  </div>    
*@
       @* <nav>
            <ul class="pagination justify-content-center">
                <li class="page-item" id="previous">
                    <a class="page-link" href="#" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>
                <li class="page-item" id="next">
                    <a class="page-link" href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>*@
        

    </div>
</div>
@*
@*<script>
    function loadPage(page) {
        var pageSize = @Model.pageSize;
        $.ajax({
            url: '/Member/History?page=' + page + '&pageSize=' + pageSize,
            success: function (data) {
                $('tbody').html(data);
                updatePagination(page);
            }
        });
    }

    function updatePagination(currentPage) {
        var totalItems = @Model.total;
        var pageSize = @Model.pageSize;
        var totalPages = Math.ceil(totalItems / pageSize);
        var pagination = document.getElementById("pagination-container")
        //var pagination = $("#pagination-container");
        //pagination.empty();
        if (totalPages > 1) {
            for (var i = 1; i <= totalPages; i++) {
                var link = document.createElement("a");
                link.innerText = i;
                
                    link.addEventListener("click",function (page) {
                        return function () {
                            loadPage(page);
                        };
                    });
                
                pagination.appendChild(link);
            }
        }
        document.querySelector("#pagination-container a:first-child").click();

    }


    updatePagination(@Model.page);
</script>
    <script>
        $(document).ready(function () {
            var currentPage = 1;
            var pageSize = 10;

            function loadSubmissions() {
                $.ajax({
                url: '/Member/History?page=' + currentPage + '&pageSize=' + pageSize,
                    type: "GET",
                    data: {
                        page: currentPage,
                        pageSize: pageSize
                    },
                    success: function (data) {
                        $("#submissions-body").empty();

                        $.each(data, function (index, item) {
                            var row = "<tr>" +
                                "<td>" + item.title + "</td>" +
                                "<td>" + item.author + "</td>" +
                                "<td>" + item.dateSubmitted + "</td>" +
                                "</tr>";
                            $("#submissions-body").append(row);
                        });
                    },
                    error: function (error) {
                        console.log(error);
                    }
                });
            }

            $("#previous").click(function () {
                if (currentPage > 1) {
                    currentPage--;
                    loadSubmissions();
                }
            });

            $("#next").click(function () {
                currentPage++;
                loadSubmissions();
            });

            loadSubmissions();
        });
    </script>*@

   <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
    $(document).on('click', '.page-link', function (e) {
        e.preventDefault();
        var page = $(this).data('page');
        console.log("page");

        $.ajax({
            url: '/Member/History',
            data: { page: page },
            type: 'GET',
            success: function (result) {
                $('.submissions').html(result);
            }
        });
    });
</script>
    